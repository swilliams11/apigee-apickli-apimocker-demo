properties(
  [ parameters(
    [
      string(defaultValue: 'orgname', description: '', name: 'APIGEE_ORG', trim: false),
      string(defaultValue: 'test', description: '', name: 'APIGEE_ENV', trim: false)
    ])
  ]
)

pipeline {
    agent any
    environment {
      APIGEE_CREDS = credentials('5fcb3ed4-e653-4f04-aa98-12f8fe63165a')
    }
    stages {
        stage('deploy to Apigee') {
          steps {
            withMaven() {
              sh "mvn install -Dapigee.org=${params.APIGEE_ORG} -Dapigee.env=${params.APIGEE_ENV} -Dapigee.username=${env.APIGEE_CREDS_USR} -Dapigee.password=${env.APIGEE_CREDS_PSW} -DskipTests=true"
              }
          }
        }
    }
}
